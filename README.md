# oh-my-gift-bot
Проект для разработки Telegram-бота для трекинга праздников
## Описание
Бот помогает пользователям не забывать о важных датах (дни рождения, праздники) и предлагает персонализированные идеи подарков на основе возраста, пола и интересов получателя. Продукт разработан в рамках командного проекта студентами первого курса НИУ ВШЭ (г.Пермь) 

Ключевые особенности:
- гибкая система напоминаний,
- рекомендательная система подарков,
- хранение заметок и идей,
- интеграция с Telegram для мгновенных уведомлений.

## Функционал
- управление календарем событий,
- настраиваемые напоминания,
- персонализированный подбор подарков,
- система заметок для хранения идей,
- генератор текстов поздравлений.

## Конфигурирование приложения и работа с переменными окружения

Для гибкой настройки приложения используются переменные окружения и файл `.env`. Это позволяет удобно менять параметры работы (например, настройки базы данных, секретные ключи, параметры почты) без необходимости изменять исходный код.

### Что такое переменные окружения?

Переменные окружения — это специальные значения, которые задаются в операционной системе и могут быть использованы приложением во время выполнения. Например, можно задать имя пользователя и пароль для подключения к базе данных, не прописывая их в коде.

### Файл `.env`

Файл `.env` — это текстовый файл в корне проекта, в котором хранятся пары ключ=значение, например:

```
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=supersecret
POSTGRES_DB=db_name
```

При запуске приложения значения из `.env` автоматически подставляются в соответствующие переменные окружения.

**Важно:** Файл `.env` обычно добавляют в `.gitignore`, чтобы не хранить секретные данные (например, пароли) в репозитории.

### Как использовать переменные окружения и `.env` в этом проекте

В проекте используется библиотека [pydantic-settings](https://docs.pydantic.dev/latest/integrations/settings/), которая автоматически подгружает переменные из `.env` и окружения. Все основные параметры приложения описаны в файле `src/config.py`.

**Пример:**
Если вы хотите изменить параметры подключения к базе данных, создайте или отредактируйте файл `.env` в корне проекта и укажите нужные значения.

### Почему нельзя хранить секретные данные в исходном коде?

- **Безопасность:** Если пароли и ключи попадут в публичный репозиторий, злоумышленники смогут получить доступ к вашей базе данных или другим сервисам.
- **Гибкость:** Для разных окружений (разработка, тестирование, продакшн) удобно использовать разные настройки, не меняя код.
- **Командная работа:** Каждый разработчик может использовать свои параметры, не мешая другим.

### Как задать переменные окружения вручную

Можно задать переменные окружения прямо в терминале перед запуском приложения:

```sh
export POSTGRES_PASSWORD=supersecret
poetry run start
```

### Рекомендации по работе с переменными

- Все чувствительные и изменяемые параметры выносите в `.env` или переменные окружения.
- Не добавляйте `.env` в репозиторий.
- Для новых параметров просто добавьте их в `.env` и используйте в коде через класс `Settings` из `src/config.py`.

## Организация работы с зависимостями проекта

### Зачем нужно управление зависимостями?

В процессе разработки приложения часто требуется использовать сторонние библиотеки (например, FastAPI, Uvicorn, telebot и др.). Управление зависимостями позволяет:

- **Гарантировать, что у всех участников команды одинаковые версии библиотек** — это снижает вероятность ошибок, связанных с несовместимостью версий.
- **Автоматизировать установку и обновление библиотек** — не нужно вручную скачивать и устанавливать каждую зависимость.
- **Обеспечить воспроизводимость окружения** — приложение будет одинаково работать на разных компьютерах и серверах.

### Что такое Poetry?

[Poetry](https://python-poetry.org/) — это современный менеджер зависимостей и инструмент для управления проектами на Python. Он позволяет:
- Описывать зависимости проекта в одном файле (`pyproject.toml`)
- Устанавливать, обновлять и удалять библиотеки одной командой
- Изолировать зависимости проекта в виртуальном окружении

### Основные файлы Poetry

- **`pyproject.toml`** — основной файл конфигурации проекта. В нем указываются все зависимости, настройки проекта и скрипты запуска.
- **`poetry.lock`** — автоматически создаётся Poetry и содержит точные версии всех установленных библиотек и их зависимостей. Благодаря этому можно быть уверенным, что у всех разработчиков и на сервере будут одинаковые версии библиотек.

### Основные команды Poetry

- **Установка всех зависимостей проекта** (после клонирования репозитория):

    ```sh
    poetry install
    ```

- **Добавление новой библиотеки** (например, requests):

    ```sh
    poetry add requests
    ```

- **Удаление библиотеки** (например, requests):

    ```sh
    poetry remove requests
    ```

- **Обновление всех зависимостей до последних разрешённых версий:**

    ```sh
    poetry update
    ```

- **Запуск команд внутри виртуального окружения Poetry:**

    ```sh
    poetry run <команда>
    # Например:
    poetry run python main.py
    ```

### Рекомендации
- **Не редактируйте вручную файлы `pyproject.toml` и `poetry.lock`** — используйте только команды Poetry.
- **Всегда выполняйте `poetry install` после получения новых изменений из репозитория**, чтобы установить новые зависимости.
- **Если добавили или удалили библиотеку — обязательно закоммитьте изменения в `pyproject.toml` и `poetry.lock`.**

Подробнее о Poetry можно узнать в [официальной документации](https://python-poetry.org/docs/).
